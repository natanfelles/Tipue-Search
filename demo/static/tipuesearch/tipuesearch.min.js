(function(a){a.fn.tipuesearch=function(b){var c=a.extend({contentLocation:"tipuesearch/tipuesearch_content.json",contextBuffer:60,contextLength:60,contextStart:90,debug:false,descriptiveWords:25,highlightTerms:true,liveContent:"*",liveDescription:"*",minimumLength:3,mode:"static",newWindow:false,show:9,showContext:true,showRelated:true,showTime:true,showTitleCount:true,showURL:true,wholeWords:true},b);return this.each(function(){var g={pages:[]};a.ajaxSetup({async:false});var j=0;a("#tipue_search_content").hide().html('<div class="tipue_search_spinner"><div class="tipue_search_rect1"></div><div class="tipue_search_rect2"></div><div class="rect3"></div></div>').show();if(c.mode=="live"){for(var h=0;h<tipuesearch_pages.length;h++){a.get(tipuesearch_pages[h]).done(function(l){var i=a(c.liveContent,l).text();i=i.replace(/\s+/g," ");var o=a(c.liveDescription,l).text();o=o.replace(/\s+/g," ");var n=l.toLowerCase().indexOf("<title>");var m=l.toLowerCase().indexOf("</title>",n+7);if(n!=-1&&m!=-1){var k=l.slice(n+7,m)}else{var k=tipuesearch_string_1}g.pages.push({title:k,text:o,tags:i,url:tipuesearch_pages[h]})})}}if(c.mode=="json"){a.getJSON(c.contentLocation).done(function(i){g=a.extend({},i)})}if(c.mode=="static"){g=a.extend({},tipuesearch)}var f="";if(c.newWindow){f=' target="_blank"'}function d(m){var k=location.search;var i=(new RegExp("[?|&]"+m+"=([^&;]+?)(&|#|;|$)").exec(k)||[,""]);var l=i[1].replace(/\+/g,"%20");try{l=decodeURIComponent(l)}catch(n){l=unescape(l)}return l||null}if(d("q")){a("#tipue_search_input").val(d("q"));e(0,true)}a(this).keyup(function(i){if(i.keyCode=="13"){e(0,true)}});function e(o,Q){var I="";var F=false;var C=false;var P=true;var O=0;found=[];var r=a("#tipue_search_input").val();var M=r.toLowerCase();M=a.trim(M);if((M.match('^"')&&M.match('"$'))||(M.match("^'")&&M.match("'$"))){P=false}var k=M.split(" ");if(P){M="";for(var H=0;H<k.length;H++){var z=true;for(var K=0;K<tipuesearch_stop_words.length;K++){if(k[H]==tipuesearch_stop_words[K]){z=false;C=true}}if(z){M=M+" "+k[H]}}M=a.trim(M);k=M.split(" ")}else{M=M.substring(1,M.length-1)}if(M.length>=c.minimumLength){if(P){if(Q){var n=M;for(var H=0;H<k.length;H++){for(var K=0;K<tipuesearch_replace.words.length;K++){if(k[H]==tipuesearch_replace.words[K].word){M=M.replace(k[H],tipuesearch_replace.words[K].replace_with);F=true}}}k=M.split(" ")}var l=M;for(var H=0;H<k.length;H++){for(var K=0;K<tipuesearch_stem.words.length;K++){if(k[H]==tipuesearch_stem.words[K].word){l=l+" "+tipuesearch_stem.words[K].stem}}}k=l.split(" ");for(var H=0;H<g.pages.length;H++){var J=0;var A=g.pages[H].text;for(var K=0;K<k.length;K++){if(c.wholeWords){var B=new RegExp("\\b"+k[K]+"\\b","gi")}else{var B=new RegExp(k[K],"gi")}if(g.pages[H].title.search(B)!=-1){var E=g.pages[H].title.match(B).length;J+=(20*E)}if(g.pages[H].text.search(B)!=-1){var E=g.pages[H].text.match(B).length;J+=(20*E)}if(g.pages[H].tags.search(B)!=-1){var E=g.pages[H].tags.match(B).length;J+=(10*E)}if(g.pages[H].url.search(B)!=-1){J+=20}if(J!=0){for(var L=0;L<tipuesearch_weight.weight.length;L++){if(g.pages[H].url==tipuesearch_weight.weight[L].url){J+=tipuesearch_weight.weight[L].score}}}if(k[K].match("^-")){B=new RegExp(k[K].substring(1),"i");if(g.pages[H].title.search(B)!=-1||g.pages[H].text.search(B)!=-1||g.pages[H].tags.search(B)!=-1){J=0}}}if(J!=0){found.push({score:J,title:g.pages[H].title,desc:A,url:g.pages[H].url});O++}}}else{for(var H=0;H<g.pages.length;H++){var J=0;var A=g.pages[H].text;var B=new RegExp(M,"gi");if(g.pages[H].title.search(B)!=-1){var E=g.pages[H].title.match(B).length;J+=(20*E)}if(g.pages[H].text.search(B)!=-1){var E=g.pages[H].text.match(B).length;J+=(20*E)}if(g.pages[H].tags.search(B)!=-1){var E=g.pages[H].tags.match(B).length;J+=(10*E)}if(g.pages[H].url.search(B)!=-1){J+=20}if(J!=0){for(var L=0;L<tipuesearch_weight.weight.length;L++){if(g.pages[H].url==tipuesearch_weight.weight[L].url){J+=tipuesearch_weight.weight[L].score}}}if(J!=0){found.push({score:J,title:g.pages[H].title,desc:A,url:g.pages[H].url});O++}}}if(O!=0){if(c.showTitleCount&&j==0){var T=document.title;document.title="("+O+") "+T;j++}if(F){I+='<div id="tipue_search_warning" class="alert alert-info">'+tipuesearch_string_2+" <em>"+M+"</em>. "+tipuesearch_string_3+' <a id="tipue_search_replaced" class="alert-link">'+n+"</a></div>"}if(O==1){I+='<div id="tipue_search_results_count" class="text-muted text-right">'+tipuesearch_string_4}else{c_c=O.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");I+='<div id="tipue_search_results_count" class="text-muted text-right">'+c_c+" "+tipuesearch_string_5}if(c.showTime){var q=new Date().getTime();var s=(q-startTimer)/1000;I+=" ("+s.toFixed(2)+" "+tipuesearch_string_14+")";c.showTime=false}I+="</div>";found.sort(function(t,i){return i.score-t.score});I+='<div class="list-group">';var G=0;for(var H=0;H<found.length;H++){if(G>=o&&G<c.show+o){I+='<a href="'+found[H].url+'" class="list-group-item"'+f+'><h4 class="tipue_search_content_title list-group-item-heading">'+found[H].title+"</h4>";if(c.debug){I+='<div class="tipue_search_content_debug text-danger">Score: '+found[H].score+"</div>"}if(c.showURL){var y=found[H].url.toLowerCase();if(y.indexOf("http://")==0){y=y.slice(7)}I+='<div class="tipue_search_content_url text-muted">'+y+"</div>"}if(found[H].desc){var D=found[H].desc;if(c.showContext){k=M.split(" ");var R=found[H].desc.toLowerCase().indexOf(k[0]);if(R>c.contextStart){var x=D.substr(R-c.contextBuffer);var N=x.indexOf(" ");x=D.substr(R-c.contextBuffer+N);x=a.trim(x);if(x.length>c.contextLength){D="... "+x}}}if(P){k=M.split(" ");for(var K=0;K<k.length;K++){if(c.highlightTerms){var v=new RegExp("("+k[K]+")","gi");D=D.replace(v,"<h0011>$1<h0012>")}}}else{if(c.highlightTerms){var v=new RegExp("("+M+")","gi");D=D.replace(v,'<strong class="tipue_search_content_bold">$1</strong>')}}var u="";var S=D.split(" ");if(S.length<c.descriptiveWords){u=D}else{for(var K=0;K<c.descriptiveWords;K++){u+=S[K]+" "}}u=a.trim(u);if(u.charAt(u.length-1)!="."){u+=" ..."}u=u.replace(/h0011/g,'strong class="tipue_search_content_bold"');u=u.replace(/h0012/g,"/strong");I+='<p class="tipue_search_content_text list-group-item-text">'+u+"</p></a>"}}G++}I+="</div>";console.log(I);if(c.showRelated&&P){K=0;for(var H=0;H<tipuesearch_related.searches.length;H++){if(M==tipuesearch_related.searches[H].search){if(F){r=M}if(!K){I+='<div class="panel panel-default"><div class="tipue_search_related_title panel-heading">'+tipuesearch_string_15+' <strong class="tipue_search_related_bold">'+r+'</strong></div><div class="tipue_search_related_cols list-group">'}I+='<a class="tipue_search_related_text list-group-item" id="'+tipuesearch_related.searches[H].related+'">';if(tipuesearch_related.searches[H].before){I+='<span class="tipue_search_related_before label label-default">'+tipuesearch_related.searches[H].before+"</span> "}I+=tipuesearch_related.searches[H].related;if(tipuesearch_related.searches[H].after){I+=' <span class="tipue_search_related_after label label-default">'+tipuesearch_related.searches[H].after+"</span>"}I+="</a>";K++}}if(K){I+="</div></div>"}}if(O>c.show){var w=Math.ceil(O/c.show);var p=(o/c.show);I+='<nav class="text-center"><div id="tipue_search_foot"><ul id="tipue_search_foot_boxes" class="pagination">';if(o>0){I+='<li role="navigation"><a class="tipue_search_foot_box" accesskey="b" id="'+(o-c.show)+"_"+Q+'">'+tipuesearch_string_6+"</a></li>"}if(p<=2){var m=w;if(w>3){m=3}for(var K=0;K<m;K++){if(K==p){I+='<li class="current active" role="navigation"><span>'+(K+1)+' <span class="sr-only">(current)</span></span></li>'}else{I+='<li role="navigation"><a class="tipue_search_foot_box" id="'+(K*c.show)+"_"+Q+'">'+(K+1)+"</a></li>"}}}else{var m=p+2;if(m>w){m=w}for(var K=p-1;K<m;K++){if(K==p){I+='<li class="current active" role="navigation"><span>'+(K+1)+"</span></li>"}else{I+='<li role="navigation"><a class="tipue_search_foot_box" id="'+(K*c.show)+"_"+Q+'">'+(K+1)+"</a></li>"}}}if(p+1!=w){I+='<li role="navigation"><a class="tipue_search_foot_box" accesskey="m" id="'+(o+c.show)+"_"+Q+'">'+tipuesearch_string_7+"</a></li>"}I+="</ul></div></nav>"}}else{I+='<div id="tipue_search_warning" class="alert alert-danger"'+tipuesearch_string_8+"</div>"}}else{if(C){I+='<div id="tipue_search_warning" class="alert alert-danger">'+tipuesearch_string_8+" "+tipuesearch_string_9+"</div>"}else{I+='<div id="tipue_search_warning" class="alert alert-danger"><strong>'+tipuesearch_string_10+"</strong><ul>";if(c.minimumLength==1){I+="<li>"+tipuesearch_string_11+"</li>"}else{I+="<li>"+tipuesearch_string_12+" "+c.minimumLength+" "+tipuesearch_string_13+"</li>"}I+="</ul></div>"}}a("#tipue_search_content").hide().html(I).animate({opacity:"toggle"},500,function(){a(this).show()});a("#tipue_search_replaced").click(function(){e(0,false)});a(".tipue_search_related").click(function(){a("#tipue_search_input").val(a(this).attr("id"));e(0,true)});a(".tipue_search_foot_box").click(function(){var t=a(this).attr("id");var i=t.split("_");e(parseInt(i[0]),i[1])})}})}})(jQuery);